<header class="app-header">
  <a routerLink="/dashboard" class="logo">
    <img src="assets/threadcatch-logo.png" alt="ThreadCatch" class="logo-img">
  </a>

  <nav class="main-nav">
    <a mat-button routerLink="/opportunities" routerLinkActive="active"
       [matBadge]="stats?.pending_approval"
       [matBadgeHidden]="!stats?.pending_approval"
       matBadgeColor="warn"
       matBadgePosition="above before">
      <mat-icon>inbox</mat-icon>
      Opportunities
    </a>
    <a mat-button routerLink="/subreddits" routerLinkActive="active">
      <mat-icon>forum</mat-icon>
      Subreddits
    </a>
    <a mat-button routerLink="/replies" routerLinkActive="active"
       [matBadge]="stats?.unread_replies"
       [matBadgeHidden]="!stats?.unread_replies"
       matBadgeColor="accent"
       matBadgePosition="above before">
      <mat-icon>chat_bubble</mat-icon>
      Replies
    </a>
    <a mat-button routerLink="/analytics" routerLinkActive="active">
      <mat-icon>analytics</mat-icon>
      Analytics
    </a>
    <a mat-button routerLink="/elite" routerLinkActive="active" class="elite-nav">
      <mat-icon>auto_awesome</mat-icon>
      AI Center
    </a>
    <a mat-button routerLink="/settings" routerLinkActive="active">
      <mat-icon>settings</mat-icon>
      Settings
    </a>
  </nav>

  <div class="header-right">
    <button mat-icon-button routerLink="/support"
            class="notification-btn"
            [class.has-unread]="stats?.unread_support_count"
            [matBadge]="stats?.unread_support_count"
            [matBadgeHidden]="!stats?.unread_support_count"
            matBadgeColor="warn"
            matBadgePosition="above before"
            matTooltip="Support Messages">
      <mat-icon>mail</mat-icon>
    </button>

    <!-- Customer Selector (for multi-customer users) -->
    <div class="customer-selector" *ngIf="hasMultipleCustomers">
      <button mat-button [matMenuTriggerFor]="customerMenu" class="customer-selector-btn">
        <mat-icon>business</mat-icon>
        <span>{{ customer?.name }}</span>
        <mat-icon>arrow_drop_down</mat-icon>
      </button>
      <mat-menu #customerMenu="matMenu">
        <button mat-menu-item
                *ngFor="let c of availableCustomers"
                (click)="switchToCustomer(c.id)"
                [class.active-customer]="c.id === currentCustomerId">
          <mat-icon *ngIf="c.id === currentCustomerId">check</mat-icon>
          <mat-icon *ngIf="c.id !== currentCustomerId"></mat-icon>
          <span>{{ c.name }}</span>
        </button>
      </mat-menu>
    </div>

    <!-- Single customer display -->
    <span class="user-name" *ngIf="customer && !hasMultipleCustomers">{{ customer.name }}</span>

    <button mat-button (click)="logout()">
      <mat-icon>logout</mat-icon>
      Logout
    </button>
  </div>
</header>
