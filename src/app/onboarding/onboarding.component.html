<div class="onboarding-container">
  <div class="onboarding-card">
    <!-- Progress indicator -->
    <div class="progress-bar">
      <div class="progress-fill" [style.width.%]="(currentStep / totalSteps) * 100"></div>
    </div>
    <div class="step-indicator">Step {{ currentStep }} of {{ totalSteps }}</div>

    <!-- Step 1: Business Info -->
    <div class="step-content" *ngIf="currentStep === 1">
      <div class="step-header">
        <h1>Tell us about your business</h1>
        <p>This helps our AI generate relevant, authentic responses for you.</p>
      </div>

      <form [formGroup]="businessForm">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>What does your product/service do?</mat-label>
          <textarea matInput formControlName="product_description" rows="3"
            placeholder="e.g., We help small businesses automate their social media scheduling and analytics..."></textarea>
          <mat-hint>Be specific - this directly improves response quality</mat-hint>
          <mat-error *ngIf="productDescription?.hasError('required')">This field is required</mat-error>
          <mat-error *ngIf="productDescription?.hasError('minlength')">Please provide more detail (at least 20 characters)</mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Who is your target audience?</mat-label>
          <textarea matInput formControlName="target_audience" rows="2"
            placeholder="e.g., Small business owners, marketing managers, solopreneurs..."></textarea>
          <mat-error *ngIf="targetAudience?.hasError('required')">This field is required</mat-error>
          <mat-error *ngIf="targetAudience?.hasError('minlength')">Please provide more detail</mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Your website (optional)</mat-label>
          <input matInput formControlName="website" placeholder="https://yourcompany.com">
          <mat-hint>We'll include this in responses when appropriate</mat-hint>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Link display name (optional)</mat-label>
          <input matInput formControlName="link_display_name" placeholder="e.g., Check out our tool">
          <mat-hint>How your link will appear in responses</mat-hint>
        </mat-form-field>
      </form>

      <div class="step-actions">
        <button mat-button (click)="skipOnboarding()">Skip for now</button>
        <button mat-raised-button color="primary" (click)="nextStep()" [disabled]="isLoading">
          <mat-spinner *ngIf="isLoading" diameter="18"></mat-spinner>
          <span *ngIf="!isLoading">Continue</span>
        </button>
      </div>
    </div>

    <!-- Step 2: Add Subreddit -->
    <div class="step-content" *ngIf="currentStep === 2">
      <div class="step-header">
        <h1>Add your first subreddit</h1>
        <p>Choose a subreddit where your target audience hangs out.</p>
      </div>

      <div class="popular-subreddits">
        <p class="section-label">Popular choices:</p>
        <div class="subreddit-chips">
          <button
            *ngFor="let sub of popularSubreddits"
            mat-stroked-button
            class="subreddit-chip"
            [class.selected]="subredditForm.get('subreddit_name')?.value === sub.name"
            (click)="selectSubreddit(sub.name)">
            r/{{ sub.name }}
          </button>
        </div>
      </div>

      <form [formGroup]="subredditForm">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Subreddit name</mat-label>
          <input matInput formControlName="subreddit_name" placeholder="e.g., entrepreneur">
          <span matPrefix>r/&nbsp;</span>
          <mat-error *ngIf="subredditName?.hasError('required')">Please enter a subreddit name</mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Keywords to look for (optional)</mat-label>
          <input matInput formControlName="keywords" placeholder="e.g., looking for, recommend, help with">
          <mat-hint>Comma-separated keywords that indicate relevant posts</mat-hint>
        </mat-form-field>
      </form>

      <div class="step-actions">
        <button mat-button (click)="prevStep()">Back</button>
        <button mat-raised-button color="primary" (click)="nextStep()" [disabled]="isLoading">
          <mat-spinner *ngIf="isLoading" diameter="18"></mat-spinner>
          <span *ngIf="!isLoading">Add Subreddit</span>
        </button>
      </div>
    </div>

    <!-- Step 3: Success -->
    <div class="step-content success-step" *ngIf="currentStep === 3">
      <div class="success-icon">
        <mat-icon>check_circle</mat-icon>
      </div>
      <div class="step-header">
        <h1>You're all set!</h1>
        <p>We'll start scanning for opportunities right away. You'll see them in your dashboard within the hour.</p>
      </div>

      <div class="next-steps">
        <h3>What happens next:</h3>
        <ul>
          <li>
            <mat-icon>search</mat-icon>
            <span>We scan your subreddits for relevant conversations</span>
          </li>
          <li>
            <mat-icon>smart_toy</mat-icon>
            <span>AI identifies posts where your product is genuinely helpful</span>
          </li>
          <li>
            <mat-icon>edit</mat-icon>
            <span>We draft authentic responses for your review</span>
          </li>
          <li>
            <mat-icon>check</mat-icon>
            <span>You approve, and we post on your behalf</span>
          </li>
        </ul>
      </div>

      <div class="step-actions centered">
        <button mat-raised-button color="primary" (click)="completeOnboarding()" [disabled]="isLoading" class="large-button">
          <mat-spinner *ngIf="isLoading" diameter="18"></mat-spinner>
          <span *ngIf="!isLoading">Go to Dashboard</span>
        </button>
      </div>
    </div>
  </div>
</div>
